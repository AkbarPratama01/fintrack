# Receipt Image Upload Feature

## Overview
Fitur upload foto struk/bukti transaksi (receipt) yang bersifat **optional** untuk setiap transaksi income dan expense.

## Database Changes

### Migration
File: `database/migrations/2025_11_12_040018_add_receipt_image_to_transactions_table.php`

Menambahkan kolom baru pada tabel `transactions`:
- `receipt_image` (string, nullable) - Menyimpan path file foto struk

## Model Updates

### Transaction Model
File: `app/Models/Transaction.php`

**Fillable field ditambahkan:**
```php
'receipt_image'
```

**Accessor baru:**
```php
getReceiptImageUrlAttribute() // Return full URL untuk display foto
```

## Controller Updates

### TransactionController
File: `app/Http/Controllers/TransactionController.php`

**Validation ditambahkan:**
```php
'receipt_image' => 'nullable|image|mimes:jpeg,jpg,png,gif|max:2048'
```

**Upload handling:**
- Store: Simpan foto ke `storage/app/public/receipts/`
- Update: Hapus foto lama dan upload yang baru jika ada
- Auto-delete foto lama saat update

## View Updates

### Transaction Index Page
File: `resources/views/transactions/index.blade.php`

**Form changes:**
1. Menambahkan `enctype="multipart/form-data"` pada form
2. Field upload foto dengan preview
3. Icon indikator jika transaksi memiliki foto struk
4. Modal untuk menampilkan foto full size

**Features:**
- âœ… Drag & drop atau click to upload
- âœ… Preview image sebelum submit
- âœ… File validation (PNG, JPG, GIF, max 2MB)
- âœ… Icon indikator di tabel untuk transaksi dengan foto
- âœ… Modal viewer untuk melihat foto full size
- âœ… Support dark mode

## Usage

### Menambah Transaksi dengan Foto:
1. Klik "Add Transaction"
2. Isi semua field required (type, amount, category, wallet, date)
3. (Optional) Upload foto struk di bagian "Receipt Image"
4. Klik "Save"

### Melihat Foto Struk:
1. Di tabel transaksi, cari row yang memiliki icon ðŸ“·
2. Klik icon foto untuk melihat full size
3. Klik X atau tekan ESC untuk menutup

### Edit Transaksi:
- Jika upload foto baru saat edit, foto lama akan otomatis terhapus
- Field foto tetap optional, tidak wajib diisi saat edit

## File Storage

**Storage path:**
```
storage/app/public/receipts/
```

**Public URL:**
```
public/storage/receipts/
```

**Symlink:** Sudah dibuat dengan `php artisan storage:link`

## Technical Details

### Upload Specifications:
- Max file size: 2MB
- Allowed formats: JPEG, JPG, PNG, GIF
- Automatic filename: Generated by Laravel Storage
- Folder structure: `receipts/{random_filename}.{ext}`

### Security:
- File type validation (image only)
- File size limitation (2MB)
- Stored in protected storage folder
- Public access via symlink only

### Performance:
- Lazy loading images in table
- Thumbnail preview in upload form
- Full size view in modal
- Efficient storage management (delete old on update)

## Future Improvements (Ideas)

1. **Image Compression**: Compress foto otomatis untuk hemat storage
2. **Multiple Images**: Support upload multiple foto per transaksi
3. **OCR Integration**: Extract amount/date dari foto struk
4. **Cloud Storage**: Integrasi dengan AWS S3 atau Google Cloud
5. **Image Gallery**: View semua receipt images dalam gallery view
6. **Export**: Download semua receipt images untuk periode tertentu
7. **Image Annotations**: Tambah catatan/highlight pada foto

## Notes

- Fitur ini **optional**, transaksi tetap bisa dibuat tanpa foto
- Foto disimpan di local storage (Laravel default)
- Pastikan folder `storage/app/public` writable
- Symlink harus aktif untuk akses public
